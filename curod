REPORT ZKO_ECERCISE_CUROD_01.

*Şimdi bu 4 komutun da kullanıldığı örnek bir rapor yazalım. Senaryomuz su şekilde olacak. Müşteri
*bizden bir rapor istesin. Bu raporun kullanarak belirli bir database tablosundan istedi satırları okuyup
*ekrana yazdırabilsin, yeni kayıt oluşturabilsin, var olan kaydı güncelleyebilsin ve silebilsin.

*üstteki çalışmadan  farklı olarak;
*-create da her alan doldurulmadan  kaydedilmeyecek özelliği getirildi, kayıtta her alanın doldurulmasını zorunlu kılıyor.
*-update  sadece dolu alanları güncelliyor 
*- Read de sadece isim veya soyisim ilede  arama yapılabiliyor.


DATA: gs_str_01  TYPE  zko_deneme_t,
      gt_table_1 TYPE TABLE OF zko_deneme_t.




SELECTION-SCREEN BEGIN OF BLOCK a1 WITH FRAME TITLE TEXT-001 NO INTERVALS .
PARAMETERS: p_num    TYPE zko_deneme_t-num,
            p_name   TYPE zko_deneme_t-name,
            p_sname  TYPE zko_deneme_t-surname,
            p_arac   TYPE zko_deneme_t-arac,
            p_create RADIOBUTTON GROUP abc,
            p_read   RADIOBUTTON GROUP abc,
            p_update RADIOBUTTON GROUP abc,
            p_del    RADIOBUTTON GROUP abc.
SELECTION-SCREEN END OF BLOCK a1.


IF p_create = abap_true.

  IF p_num IS INITIAL.

    MESSAGE 'Numara bilgisi olmadan kayıt yapılamaz ' TYPE 'S' DISPLAY LIKE 'E'.

  ELSE.

    SELECT SINGLE * FROM zko_deneme_t INTO gs_str_01 WHERE num = p_num.

    IF sy-subrc = 0 .

      MESSAGE 'Aynı numaraya sahip iki kayıt olamaz,lütfen numarayı değistirin' TYPE 'S' DISPLAY LIKE 'E'.


    ELSE."5

      IF p_name   IS NOT INITIAL.



        IF  p_sname   IS NOT INITIAL.



          IF  p_arac  IS NOT INITIAL.

            gs_str_01-num     = p_num.
            gs_str_01-name    = p_name.
            gs_str_01-surname = p_sname.
            gs_str_01-arac    = p_arac.

            INSERT zko_deneme_t FROM gs_str_01.

              IF sy-subrc = 0.

                MESSAGE 'Kayıt Başarılı bir şekilde eklendi' TYPE 'S'.

              ELSE.

                MESSAGE 'Kayıt Eklenemedi'TYPE 'S' DISPLAY LIKE 'E'.

              ENDIF.

          ELSE.

          MESSAGE 'Kayıt için her alanın doldurulması gerekir' TYPE 'S' DISPLAY LIKE 'E'.

          ENDIF.


        ELSE.

          MESSAGE 'Kayıt için her alanın doldurulması gerekir' TYPE 'S' DISPLAY LIKE 'E'.

        ENDIF.

      ELSE.

        MESSAGE 'Kayıt için her alanın doldurulması gerekir' TYPE 'S' DISPLAY LIKE 'E'.

      ENDIF.


    ENDIF.


  ENDIF.

    CLEAR gs_str_01.




ELSEIF p_read = abap_true.

  IF p_num IS INITIAL .
*
    IF p_name IS INITIAL .

      IF p_sname IS INITIAL .

          SELECT * FROM zko_deneme_t INTO TABLE gt_table_1.

             IF sy-subrc = 0.

                 LOOP AT gt_table_1 INTO gs_str_01.

                  WRITE:  / gs_str_01-num ,
                  / gs_str_01-name ,
                  / gs_str_01-surname,
                  / gs_str_01-arac .
                  SKIP.
                  ULINE.
                  CLEAR gs_str_01.
                  ENDLOOP.
             ELSE.

                MESSAGE 'Tabloda herhangi bir kayıt bulunmamaktadır.' TYPE 'S' DISPLAY LIKE 'E'.

             ENDIF.
        ELSE.

          SELECT  * FROM zko_deneme_t INTO TABLE gt_table_1 WHERE surname = p_sname .

            IF sy-subrc = 0.

                LOOP AT gt_table_1 INTO gs_str_01.

                  WRITE:  / gs_str_01-num ,
                  / gs_str_01-name ,
                  / gs_str_01-surname,
                  / gs_str_01-arac .
                  SKIP.
                  ULINE.
                  CLEAR gs_str_01.
                ENDLOOP.

             ELSE.

               MESSAGE 'ISTENEN KAYITLAR BULUNAMADI' TYPE'S' DISPLAY LIKE 'E'.

             ENDIF.

          ENDIF.

     ELSE.

        SELECT  * FROM zko_deneme_t INTO TABLE  gt_table_1 WHERE  name = p_name.

            IF sy-subrc = 0.

                LOOP AT gt_table_1 INTO gs_str_01.

                  WRITE:  / gs_str_01-num ,
                  / gs_str_01-name ,
                  / gs_str_01-surname,
                  / gs_str_01-arac .
                  SKIP.
                  ULINE.
                  CLEAR gs_str_01.
                ENDLOOP.

             ELSE.

               MESSAGE 'ISTENEN KAYITLAR BULUNAMADI' TYPE'S' DISPLAY LIKE 'E'.

             ENDIF.

        ENDIF.



  ELSE .

    SELECT  * FROM zko_deneme_t INTO TABLE gt_table_1 WHERE num = p_num .

      IF sy-subrc = 0 .
      LOOP.

      WRITE:    / gs_str_01-num ,
                / gs_str_01-name ,
                / gs_str_01-surname,
                / gs_str_01-arac .
      SKIP.
      ULINE.
      CLEAR gs_str_01.
      ENDLOOP.
      ELSE.

      MESSAGE 'Girilen Numaraya ait bir kayıt bulunamadı.'TYPE 'S' DISPLAY LIKE'E'.

    ENDIF.

  ENDIF.


ELSEIF p_update = abap_true.

  IF p_num IS  INITIAL.

    MESSAGE 'Numara bilgisi olmadan kayıt değiştirilemez' TYPE 'S' DISPLAY LIKE 'E'.

  ELSE.

    IF p_name IS NOT INITIAL .

      SELECT SINGLE * FROM zko_deneme_t INTO gs_str_01 WHERE num = p_num.

      IF sy-subrc = 0.

      UPDATE zko_deneme_t  SET name       = p_name
                               WHERE num  = p_num.

        IF sy-subrc = 0.

          MESSAGE 'Kayıt başarıyla güncellendi'TYPE 'I'.

        ELSE.

          MESSAGE 'KAYIT DEĞİŞTİRİLEMEDİ' TYPE 'S' DISPLAY LIKE 'E'.

        ENDIF.

      ELSE .

      MESSAGE 'Girilen Numaraya ait kayıt bulunamadı'TYPE 'S' DISPLAY LIKE 'E'.



      ENDIF.

    ELSEIF  p_sname IS NOT INITIAL .

      SELECT SINGLE * FROM zko_deneme_t INTO gs_str_01 WHERE num = p_num.

      IF sy-subrc = 0.

      UPDATE zko_deneme_t  SET surname       = p_sname
                               WHERE num  = p_num.

        IF sy-subrc = 0.

          MESSAGE 'Kayıt başarıyla güncellendi'TYPE 'I'.

        ELSE.

          MESSAGE 'KAYIT DEĞİŞTİRİLEMEDİ' TYPE 'S' DISPLAY LIKE 'E'.

        ENDIF.

      ELSE .

      MESSAGE 'Girilen Numaraya ait kayıt bulunamadı'TYPE 'S' DISPLAY LIKE 'E'.



      ENDIF.
    ELSEIF p_arac IS NOT INITIAL .

      SELECT SINGLE * FROM zko_deneme_t INTO gs_str_01 WHERE num = p_num.

      IF sy-subrc = 0.

      UPDATE zko_deneme_t  SET arac      = p_arac
                               WHERE num  = p_num.

        IF sy-subrc = 0.

          MESSAGE 'Kayıt başarıyla güncellendi'TYPE 'I'.

        ELSE.

          MESSAGE 'KAYIT DEĞİŞTİRİLEMEDİ' TYPE 'S' DISPLAY LIKE 'E'.

        ENDIF.

      ELSE .

      MESSAGE 'Girilen Numaraya ait kayıt bulunamadı'TYPE 'S' DISPLAY LIKE 'E'.



      ENDIF.

    ENDIF.


      CLEAR gs_str_01.

  ENDIF.

ELSEIF p_del = abap_true.

  IF p_num IS INITIAL.

    MESSAGE 'Numara bilgisi olmadan kayıt silinemez' TYPE 'S' DISPLAY LIKE 'E'.

  ELSE.

    SELECT SINGLE * FROM zko_deneme_t INTO gs_str_01 WHERE num = p_num.

      IF sy-subrc = 0.

        DELETE FROM zko_deneme_t WHERE num = p_num.

          IF sy-subrc = 0.

            MESSAGE 'Kayıt başarıyla silindi'TYPE 'I'.

          ELSE.

          MESSAGE 'KAYIT silinemedi' TYPE 'S' DISPLAY LIKE 'E'.

          ENDIF.

      ELSE.

        MESSAGE 'KAYIT Bulunamadı' TYPE 'S' DISPLAY LIKE 'E'.

      ENDIF.


  ENDIF.

  CLEAR gs_str_01.

ENDIF.
